{% extends "core/base_public.html" %}
{% load static %}

{% block title %}{{ teacher.get_full_name }} - SikshaSetu{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'core/css/teachers.css' %}">
<link rel="stylesheet" href="{% static 'core/css/courses.css' %}">
{% endblock %}

{% block content %}

<!-- Hero Profile Section -->
<section class="profile-hero text-center py-5" style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);">
    <div class="container">
        <div class="d-flex flex-column align-items-center">
            <!-- Profile Avatar -->
            <div class="profile-avatar-container mb-4">
                {% if teacher.profile_picture %}
                <img src="{{ teacher.profile_picture.url }}" class="profile-avatar-lg"
                    alt="{{ teacher.get_full_name }}">
                {% else %}
                <div class="profile-avatar-placeholder d-flex align-items-center justify-content-center mx-auto"
                    style="width: 180px; height: 180px; background: linear-gradient(135deg, var(--primary-blue) 0%, var(--mint-green) 100%); color: white; font-size: 4rem; border-radius: 50%;">
                    {{ teacher.get_short_name|first }}
                </div>
                {% endif %}
            </div>

            <!-- Name and Title -->
            <h1 class="fw-bold mb-2 display-5" style="color: var(--primary-blue);">{{ teacher.get_full_name }}</h1>
            <p class="text-muted fw-bold text-uppercase ls-1 mb-3" style="color: var(--mint-green);">Instructor</p>

            <!-- Bio -->
            <p class="text-dark mb-4 mx-auto" style="max-width: 700px; font-size: 1.1rem; line-height: 1.6;">
                {{ teacher.bio|default:"Experienced educator with a passion for teaching and sharing knowledge." }}
            </p>

            <!-- Stats -->
            <div class="d-flex gap-4 flex-wrap justify-content-center">
                <div class="profile-stat-box">
                    <span class="stat-number">{{ teacher.course_count|default:"0" }}</span>
                    <span class="stat-label">Courses</span>
                </div>
                <div class="profile-stat-box">
                    <span class="stat-number">{{ teacher.student_count|default:"0" }}</span>
                    <span class="stat-label">Students</span>
                </div>
                <div class="profile-stat-box">
                    <span class="stat-number">{{ teacher.avg_rating|default:"0.0"|floatformat:1 }}</span>
                    <span class="stat-label">
                        <i class="fas fa-star text-warning"></i> Rating
                    </span>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Main Content -->
<section class="py-5">
    <div class="container">
        <div class="row g-5">
            <!-- Left Content: Courses -->
            <div class="col-lg-8">
                <!-- Courses Header -->
                <div class="d-flex align-items-center mb-4">
                    <h3 class="fw-bold mb-0" style="color: var(--primary-blue);">Courses by {{ teacher.first_name }}
                    </h3>
                    <span class="badge bg-light text-dark ms-3 rounded-pill"
                        style="border: 1px solid var(--mint-green);">
                        {{ courses.count }} Courses
                    </span>
                </div>

                <!-- Course List -->
                <div class="row g-4">
                    {% for course in courses %}
                    <div class="col-md-6">
                        <div class="card course-card-grid h-100">
                            <div class="course-thumb-wrapper position-relative">
                                <span class="course-badge position-absolute top-0 start-0 m-2 
                                    {% if course.level == 'beginner' %}bg-success
                                    {% elif course.level == 'intermediate' %}bg-warning
                                    {% else %}bg-danger{% endif %}">
                                    {{ course.get_level_display }}
                                </span>
                                <img src="{{ course.get_thumbnail }}" class="course-thumb"
                                    alt="{{ course.title }} Thumbnail" loading="lazy">
                            </div>
                            <div class="card-body course-content d-flex flex-column p-3">
                                <h5 class="card-title fw-bold mb-2">{{ course.title }}</h5>
                                <div class="course-rating mb-2">
                                    <i class="fas fa-star text-warning"></i>
                                    <span class="fw-bold ms-1">{{ course.get_average_rating|default:"0.0" }}</span>
                                    <span class="text-muted ms-1">({{ course.reviews.count|default:"0" }})</span>
                                </div>
                                <p class="card-text text-muted small flex-grow-1">
                                    {{ course.short_description|truncatechars:100|default:"No description available" }}
                                </p>
                                <div class="course-meta d-flex justify-content-between text-muted small mt-2">
                                    <span><i class="far fa-clock me-1"></i> {{ course.total_duration_display }}</span>
                                    <span><i class="fas fa-video me-1"></i> {{ course.lessons.count|default:"0" }}
                                        Lessons</span>
                                </div>
                                <div class="d-flex justify-content-between align-items-center mt-3">
                                    <h5 class="text-primary mb-0 fw-bold">
                                        {% if course.is_free %}Free{% else %}â‚¹{{ course.price }}{% endif %}
                                    </h5>
                                    <a href="{% url 'courses:course_detail' course.slug %}"
                                        class="btn btn-view-course rounded-pill"
                                        style="background-color: var(--mint-green); border-color: var(--mint-green); color: white;">
                                        View Course
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% empty %}
                    <div class="col-12 text-center py-5">
                        <h4 class="text-muted">No courses published yet.</h4>
                        <p class="text-muted">Check back soon for new courses from {{ teacher.first_name }}!</p>
                    </div>
                    {% endfor %}
                </div>
            </div>

            <!-- Right Sidebar: Info -->
            <div class="col-lg-4">
                <!-- Professional Info Card -->
                <div class="profile-sidebar-card mb-4">
                    <h5 class="sidebar-title mb-3">Professional Info</h5>
                    <ul class="list-unstyled info-list">
                        <li class="mb-3">
                            <i class="fas fa-graduation-cap text-primary me-2"></i>
                            <div>
                                <strong>Education:</strong><br>
                                <span class="text-muted">{{ profile.education|default:"Not provided" }}</span>
                            </div>
                        </li>
                        <li class="mb-3">
                            <i class="fas fa-briefcase text-primary me-2"></i>
                            <div>
                                <strong>Experience:</strong><br>
                                <span class="text-muted">{{ profile.experience|default:"Not provided" }}</span>
                            </div>
                        </li>
                        <li class="mb-3">
                            <i class="fas fa-map-marker-alt text-primary me-2"></i>
                            <div>
                                <strong>Location:</strong><br>
                                <span class="text-muted">{{ profile.location|default:"Not provided" }}</span>
                            </div>
                        </li>
                        <li class="mb-3">
                            <i class="fas fa-language text-primary me-2"></i>
                            <div>
                                <strong>Languages:</strong><br>
                                <span class="text-muted">{{ profile.languages|default:"Not provided" }}</span>
                            </div>
                        </li>
                    </ul>
                </div>

                <!-- Contact Card -->
                <div class="profile-sidebar-card">
                    <h5 class="sidebar-title mb-3">Contact {{ teacher.first_name }}</h5>
                    {% if user.is_authenticated %}
                    <p class="text-muted small mb-3">Send a direct message to this instructor.</p>
                    <form action="{% url 'core:send_teacher_message' teacher.id %}" method="post">
                        {% csrf_token %}
                        <div class="mb-3">
                            <textarea name="message" class="form-control rounded-3" rows="4"
                                placeholder="Type your message here..."
                                style="border: 1px solid #dee2e6; resize: none;"></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary w-100 rounded-pill fw-bold py-2"
                            style="background-color: var(--mint-green); border-color: var(--mint-green);">
                            Send Message
                        </button>
                    </form>
                    {% else %}
                    <p class="text-muted small mb-3">Please login to contact this teacher.</p>
                    <a href="{% url 'accounts:login' %}?next={{ request.path }}"
                        class="btn btn-outline-primary w-100 rounded-pill fw-bold py-2"
                        style="border-color: var(--mint-green); color: var(--mint-green);">
                        Login to Contact
                    </a>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}